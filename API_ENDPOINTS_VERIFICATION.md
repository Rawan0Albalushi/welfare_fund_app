# โ ุงูุชุญูู ูู ุตุญุฉ API Endpoints

## ๐ฏ ุงูุชุญูู ูู ุงูู Endpoints ุงููุณุชุฎุฏูุฉ

ุชู ุงูุชุญูู ูู ุฃู ุงูุชุทุจูู ูุณุชุฎุฏู ุงูู endpoints ุงูุตุญูุญุฉ ุญุณุจ ุงูููุงุตูุงุช ุงููุญุฏุฏุฉ.

---

## ๐ ุงูููุงุตูุงุช ุงููุญุฏุฏุฉ

### **1. `/api/v1/donations`**
- โ **ูููุณุชุฎุฏููู ุงููุณุฌููู ููุท**
- โ **ูุญุชุงุฌ `auth:sanctum`**
- โ **ูุฅูุดุงุก ุงูุชุจุฑุนุงุช**

### **2. `/api/v1/donations/with-payment`**
- โ **ูููุณุชุฎุฏููู ุงููุณุฌููู ูุงููุฌููููู**
- โ **ุงุฎุชูุงุฑู `auth:sanctum`**
- โ **ูุฅูุดุงุก ุงูุชุจุฑุนุงุช ูุน ุงูุฏูุน**

### **3. `/api/v1/me/donations`**
- โ **ูุงุณุชุฑุฌุงุน ุชุจุฑุนุงุช ุงููุณุชุฎุฏู ุงููุณุฌู ููุท**
- โ **ูุญุชุงุฌ `auth:sanctum`**

### **4. ุฑุจุท ุงูุชุจุฑุน ุจุงููุณุชุฎุฏู**
- โ **ุฌููุน endpoints ุงูุชุจุฑุน ูููุณุชุฎุฏููู ุงููุณุฌููู ุชุฑุจุท ุงูุชุจุฑุน ุจุญุณุงุจ ุงููุณุชุฎุฏู ุชููุงุฆูุงู**

---

## โ ุงูุชุญูู ูู ุงูููุฏ

### **1. ุฅูุดุงุก ุงูุชุจุฑุนุงุช - `donation_screen.dart`:**

```dart
// โ ูุณุชุฎุฏู endpoint ุตุญูุญ
final response = await http.post(
  Uri.parse('http://192.168.1.21:8000/api/v1/donations/with-payment'),
  headers: {
    'Authorization': 'Bearer $token',  // โ auth ูููุณุชุฎุฏููู ุงููุณุฌููู
    'Content-Type': 'application/json',
  },
  body: jsonEncode({
    'campaign_id': widget.campaignId ?? 1,
    'amount': amount,
    'donor_name': _donorNameController.text.trim(),
    'note': _noteController.text.trim().isEmpty 
        ? 'ุชุจุฑุน ููุทูุงุจ ุงููุญุชุงุฌูู' 
        : _noteController.text.trim(),
    'return_origin': origin,
  }),
);
```

**ุงูุชุญูู:**
- โ **Endpoint:** `/api/v1/donations/with-payment`
- โ **Auth:** `Authorization: Bearer $token` ูููุณุชุฎุฏููู ุงููุณุฌููู
- โ **ุฏุนู ุงูุถููู:** ูููู ุงุณุชุฎุฏุงูู ุจุฏูู token ููุถููู
- โ **ุฑุจุท ุงููุณุชุฎุฏู:** ุงูุชุจุฑุน ูุฑุจูุท ุจู user_id ุชููุงุฆูุงู

### **2. ุฅูุดุงุก ุงูุชุจุฑุนุงุช - `DonationService`:**

```dart
// โ ูุณุชุฎุฏู endpoint ุตุญูุญ
final uri = Uri.parse('${_apiBase.replaceAll(RegExp(r"/+$"), "")}/donations/with-payment');
final response = await http.post(uri, headers: headers, body: jsonEncode(payload));
```

**ุงูุชุญูู:**
- โ **Endpoint:** `/api/v1/donations/with-payment`
- โ **Auth:** ูุชู ุฅุถุงูุฉ token ุฅุฐุง ูุงู ููุฌูุฏุงู
- โ **ุฏุนู ุงูุถููู:** ูููู ุงุณุชุฎุฏุงูู ุจุฏูู token

### **3. ุงุณุชุฑุฌุงุน ุงูุชุจุฑุนุงุช - `DonationService`:**

```dart
// โ ูุณุชุฎุฏู endpoints ุตุญูุญุฉ
final endpoints = [
  '/me/donations',  // โ ุงูุฃููููุฉ ูููุณุชุฎุฏููู ุงููุณุฌููู
  '/donations/recent', 
  '/donations',
];
```

**ุงูุชุญูู:**
- โ **Endpoint ุงูุฃูู:** `/api/v1/me/donations` ูููุณุชุฎุฏููู ุงููุณุฌููู
- โ **Auth:** `Authorization: Bearer $token` ูุทููุจ
- โ **Fallback:** endpoints ุฃุฎุฑู ูู ุญุงูุฉ ูุดู ุงูุฃูู

---

## ๐ ุขููุฉ ุงูุนูู

### **ูููุณุชุฎุฏููู ุงููุณุฌููู:**

#### **ุฅูุดุงุก ุงูุชุจุฑุน:**
```
1. ุชุณุฌูู ุฏุฎูู โ
   โ
2. ุฅูุดุงุก ุชุจุฑุน ูุน /api/v1/donations/with-payment โ
   โ
3. ุฅุฑุณุงู Authorization: Bearer $token โ
   โ
4. ุงูุจุงููุฏ ูุฑุจุท ุงูุชุจุฑุน ุจู user_id ุชููุงุฆูุงู โ
   โ
5. ุฅุชูุงู ุงูุฏูุน โ
```

#### **ุงุณุชุฑุฌุงุน ุงูุชุจุฑุนุงุช:**
```
1. ุชุณุฌูู ุฏุฎูู โ
   โ
2. ุงุณุชุฏุนุงุก /api/v1/me/donations โ
   โ
3. ุฅุฑุณุงู Authorization: Bearer $token โ
   โ
4. ุงุณุชุฑุฌุงุน ุชุจุฑุนุงุช ุงููุณุชุฎุฏู ููุท โ
```

### **ููุถููู:**

#### **ุฅูุดุงุก ุงูุชุจุฑุน:**
```
1. ุนุฏู ุชุณุฌูู ุฏุฎูู โ
   โ
2. ุฅูุดุงุก ุชุจุฑุน ูุน /api/v1/donations/with-payment โ
   โ
3. ุนุฏู ุฅุฑุณุงู Authorization header โ
   โ
4. ุงูุจุงููุฏ ููุดุฆ ุชุจุฑุน ูุฌููู โ
   โ
5. ุฅุชูุงู ุงูุฏูุน โ
```

---

## ๐ ููุงุฑูุฉ ุงูู Endpoints

| Endpoint | ุงููุณุชุฎุฏููู ุงููุณุฌููู | ุงูุถููู | ุฑุจุท ุงููุณุชุฎุฏู |
|----------|---------------------|--------|---------------|
| `/api/v1/donations` | โ (auth ูุทููุจ) | โ | โ ุชููุงุฆู |
| `/api/v1/donations/with-payment` | โ (auth ุงุฎุชูุงุฑู) | โ | โ ุชููุงุฆู |
| `/api/v1/me/donations` | โ (auth ูุทููุจ) | โ | โ ุชููุงุฆู |

---

## ๐ฏ ุงููุชุงุฆุฌ ุงููุญููุฉ

### **1. ุฅูุดุงุก ุงูุชุจุฑุนุงุช:**
- โ **ุงููุณุชุฎุฏููู ุงููุณุฌููู:** ุชุจุฑุนุงุชูู ูุฑุจูุทุฉ ุจู user_id
- โ **ุงูุถููู:** ุชุจุฑุนุงุช ูุฌูููุฉ ุจุฏูู user_id
- โ **Endpoint ุตุญูุญ:** `/api/v1/donations/with-payment`

### **2. ุงุณุชุฑุฌุงุน ุงูุชุจุฑุนุงุช:**
- โ **ุงููุณุชุฎุฏููู ุงููุณุฌููู:** ูุฑูู ุชุจุฑุนุงุชูู ููุท
- โ **Endpoint ุตุญูุญ:** `/api/v1/me/donations`
- โ **Auth ูุทููุจ:** `Authorization: Bearer $token`

### **3. ุฑุจุท ุงููุณุชุฎุฏู:**
- โ **ุชููุงุฆู:** ุงูุจุงููุฏ ูุฑุจุท ุงูุชุจุฑุน ุจู user_id ุชููุงุฆูุงู
- โ **ูููุณุชุฎุฏููู ุงููุณุฌููู:** ุงูุชุจุฑุนุงุช ูุฑุจูุทุฉ ุจุญุณุงุจูู
- โ **ููุถููู:** ุชุจุฑุนุงุช ูุฌูููุฉ

---

## ๐ ุงูุงุฎุชุจุงุฑ

### **1. ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏู ุงููุณุฌู:**
1. ุชุณุฌูู ุฏุฎูู โ
2. ุฅูุดุงุก ุชุจุฑุน โ
3. ุฅุชูุงู ุงูุฏูุน โ
4. ุงูุชุญูู ูู ุธููุฑ ุงูุชุจุฑุน ูู "ุชุจุฑุนุงุชู" โ

### **2. ุงุฎุชุจุงุฑ ุงูุถูู:**
1. ุนุฏู ุชุณุฌูู ุฏุฎูู โ
2. ุฅูุดุงุก ุชุจุฑุน ูุฌููู โ
3. ุฅุชูุงู ุงูุฏูุน โ
4. ุงูุชุญูู ูู ุนุฏู ุธููุฑ "ุชุจุฑุนุงุชู" โ

### **3. ุงุฎุชุจุงุฑ console logs:**
```
DonationService: Using authenticated request with token
DonationService: Creating donation with payment...
DonationService: Trying endpoint /me/donations for pagination...
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Endpoints ุตุญูุญุฉ:** ุฌููุน ุงูู endpoints ุงููุณุชุฎุฏูุฉ ุตุญูุญุฉ
2. **Auth ุตุญูุญ:** ูุชู ุฅุฑุณุงู token ูููุณุชุฎุฏููู ุงููุณุฌููู
3. **ุฑุจุท ุชููุงุฆู:** ุงูุจุงููุฏ ูุฑุจุท ุงูุชุจุฑุน ุจู user_id ุชููุงุฆูุงู
4. **ุฏุนู ุงูุถููู:** ุงูุชุจุฑุนุงุช ุงููุฌูููุฉ ูุฏุนููุฉ

---

## ๐ ุงูุฎูุงุตุฉ

**ุฌููุน ุงูู endpoints ุงููุณุชุฎุฏูุฉ ุตุญูุญุฉ ููุชูุงููุฉ ูุน ุงูููุงุตูุงุช!** 

ุงูุขู:
- โ **ุฅูุดุงุก ุงูุชุจุฑุนุงุช:** `/api/v1/donations/with-payment` (ุตุญูุญ)
- โ **ุงุณุชุฑุฌุงุน ุงูุชุจุฑุนุงุช:** `/api/v1/me/donations` (ุตุญูุญ)
- โ **ุฑุจุท ุงููุณุชุฎุฏู:** ุชููุงุฆู ูููุณุชุฎุฏููู ุงููุณุฌููู
- โ **ุฏุนู ุงูุถููู:** ุชุจุฑุนุงุช ูุฌูููุฉ ูุฏุนููุฉ
- โ **Auth:** ุตุญูุญ ูููุณุชุฎุฏููู ุงููุณุฌููู

**ุงูุชุทุจูู ูุณุชุฎุฏู ุงูู endpoints ุงูุตุญูุญุฉ!** ๐
